#! /usr/bin/perl -w

use strict;

# For testing, change name of $dest_file...

my $dest_file = '/etc/cron.d/tuttle_job';
my $temp_file = $dest_file . '.new'; # Vixie cron won't run '.new' crontabs

# Job runs after 9:00 PM, at a random minute...

my $rmin = sprintf("%02d", int(rand(60)));

open (OUT, ">$temp_file") or die "Couldn't create $temp_file";

(print OUT <<EOF) or die "Couldn't write $temp_file";
# Automatically generated by /gold/tuttle/bin/install

MAILTO=sysadmin

export PATH=/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/sbin:\$PATH

$rmin 21 * * * root   goldpull tuttle; /gold/tuttle/bin/tuttle-master-job
EOF

(close OUT) or die "Couldn't write $temp_file";

(rename $temp_file, $dest_file) or die "Couldn't install $dest_file";

